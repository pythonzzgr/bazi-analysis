# **Phase 1: 사주 8자 계산 (Four Pillars Calculation)**

사주 분석의 첫 번째 단계는 입력된 생년월일시를 천문학적 기준에 따라 간지(干支) 데이터로 변환하는 것입니다.

### **1\. 입력 데이터 (Input Data)**

* solar\_datetime: 양력 날짜 및 시간 (ISO 8601 형식 권장)  
* location: 출생지 (경도 포함, 표준시 보정용)  
* gender: 남성/여성 (대운 계산에 필수)  
* calendar\_type: 양력/음력/윤달 여부

### **2\. 핵심 처리 로직 (Processing Logic)**

* **만세력 DB 연동:** 1900년\~2100년 사이의 절기(Solar Terms) 시각 데이터를 참조합니다.  
* **월건(月建) 결정:** 단순히 월이 바뀌는 시점이 아니라, 입춘(立春), 경칩(驚蟄) 등 해당 월의 '절입 시각'을 기준으로 바뀝니다.  
* **시간 보정:** \- **경도 보정:** 한국 표준시(135도)와 실제 경도(127.5도)의 차이인 30분\~32분을 차감합니다.  
  * **썸머타임:** 시행 기간 출생자의 경우 1시간을 차감합니다.  
* **야자시/조자시:** 23:00\~00:00 사이 출생 시 일간(日干)은 당일로 두되 시간만 자시(子時)로 볼지, 다음 날로 볼지에 대한 엔진 옵션을 설정합니다.

### **3\. 출력 데이터 구조 (Output Structure)**

{  
  "pillars": {  
    "year":  {"stem": "甲", "branch": "子"},  
    "month": {"stem": "丙", "branch": "寅"},  
    "day":   {"stem": "戊", "branch": "辰"},  
    "time":  {"stem": "庚", "branch": "申"}  
  },  
  "metadata": {  
    "solar\_term": "입춘(立春)",  
    "adjusted\_time": "2023-02-04T10:30:00"  
  }  
}

**Reference:** 『명리정종(命理正宗)』 원전 기반 시간 경계론 참조.